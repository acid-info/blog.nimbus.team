"use strict";(self.webpackChunklogos_blog_template=self.webpackChunklogos_blog_template||[]).push([[866],{43358:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>h});var n=a(87462),r=(a(67294),a(3905));const i={layout:"post",title:"The importance of light nodes in Vitalik's endgame",description:"Ethereum can support both full nodes and light clients, it contains a peer to peer layer which allows nodes to send messages to each other.",date:"2021-12-10T10:00",authors:"sacha",published:!0},o="Nimbus client 2022 year-end recap",s={permalink:"/light-nodes-ethereum-endgame",source:"@site/posts/light-nodes-ethereum-endgame.md",title:"The importance of light nodes in Vitalik's endgame",description:"Ethereum can support both full nodes and light clients, it contains a peer to peer layer which allows nodes to send messages to each other.",date:"2021-12-10T10:00:00.000Z",formattedDate:"December 10, 2021",tags:[],readingTime:4.5,hasTruncateMarker:!0,authors:[{name:"Sacha",key:"sacha"}],frontMatter:{layout:"post",title:"The importance of light nodes in Vitalik's endgame",description:"Ethereum can support both full nodes and light clients, it contains a peer to peer layer which allows nodes to send messages to each other.",date:"2021-12-10T10:00",authors:"sacha",published:!0},prevItem:{title:"Nimbus Consensus Layer - past, present, and future",permalink:"/nimbus-consensus-layer-2122"},nextItem:{title:"Nimbus + Nethermind - Kintsugi tutorial",permalink:"/kintsugi-merge"}},l={authorsImageUrls:[void 0]},h=[{value:"Preface",id:"preface",level:3},{value:"Relaxing assumptions",id:"relaxing-assumptions",level:3},{value:"A light sketch",id:"a-light-sketch",level:3},{value:"What does this tell us?",id:"what-does-this-tell-us",level:3},{value:"A means to self-sovereignty",id:"a-means-to-self-sovereignty",level:3},{value:"Resources",id:"resources",level:3}],c={toc:h};function p(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"header-image",src:a(24866).Z,width:"720",height:"577"})),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"image courtesy of ",(0,r.kt)("a",{parentName:"em",href:"https://vitalik.ca/general/2021/12/06/endgame.html"},"Vitalik's endgame post"))),(0,r.kt)("h3",{id:"preface"},"Preface"),(0,r.kt)("p",null,"Ethereum can support both full nodes and light clients, it contains a peer to peer layer which allows nodes to send messages to each other. While Ethereum's current architecture is not particularly well-suited to light clients, the beacon chain architecture is. This means that post-merge, they will have an important role to play. A light client is a cheaper alternative to a full node (from a bandwidth and resource consumption perspective) since it only downloads the header from each block and trusts the full nodes to check that the state transitions are correct (in other words, a light client trusts the full nodes it is peered with to verify that the block producer hasn't tried to print new coins, \xa0spend coins from an address for which they don\u2019t have the private key, or make larger blocks than the consensus rules allow them to do). This does beg the question however: under what assumptions are light clients able to protect themselves from malicious block producers?"),(0,r.kt)("h3",{id:"relaxing-assumptions"},"Relaxing assumptions"),(0,r.kt)("p",null,"In ",(0,r.kt)("a",{parentName:"p",href:"https://vitalik.ca/general/2021/12/06/endgame.html"},"the endgame"),", we expect that most individuals will transact on Ethereum using light clients without even knowing it. For example, the plan has always been for the ",(0,r.kt)("a",{parentName:"p",href:"https://status.im/get/"},"Status mobile app")," to come integrated with a light version of Nimbus.  "),(0,r.kt)("p",null,"Since light clients typically only download block headers, and don\u2019t verify transactions themselves, we are used to thinking of them as having weak security guarantees compared to full nodes: under the conventional model, they are forced to rely on an honest majority assumption (which means they must assume the chain is valid by default).  "),(0,r.kt)("p",null,"However, it turns out that we can do significantly better than that."),(0,r.kt)("p",null,"Thanks to the magic of ",(0,r.kt)("a",{parentName:"p",href:"https://arxiv.org/abs/1809.09044"},"fraud and data availability proofs"),", we can relax the honest majority assumption, and make a 1/N honesty assumption instead. Practically speaking this means a light client only needs to be peered with a ",(0,r.kt)("em",{parentName:"p"},"single")," honest full node in order to inherit almost the same security guarantees. In the rest of this post we will refer to this genre of light client as a ",(0,r.kt)("em",{parentName:"p"},"light node"),"."),(0,r.kt)("h3",{id:"a-light-sketch"},"A light sketch"),(0,r.kt)("p",null,"While we won't get into the ",(0,r.kt)("a",{parentName:"p",href:"https://dankradfeist.de/ethereum/2019/12/20/data-availability-checks.html"},"gory details")," here, here's a light sketch of how this works."),(0,r.kt)("p",null,"When a light node receives a block header, it ",(0,r.kt)("a",{parentName:"p",href:"https://coinmarketcap.com/alexandria/article/what-is-data-availability"},"probabilistically samples")," enough shares from the ",(0,r.kt)("a",{parentName:"p",href:"https://blog.iden3.io/merkle-trees-visual-introduction.html"},"Merkle tree")," that the Merkle root represents to convince itself that the entire tree is indeed available for full nodes to verify (in other words, the light node is able to verify that the block producer has not withheld any data from the network)."),(0,r.kt)("p",null,"At the same time, it listens for fraud proofs \u2013 a small, and quickly verifiable proof that a specific transaction in a block is invalid \u2013 from the nodes it is peered with. A valid fraud proof convinces that light node that the Merkle root in the block header is in fact incorrect. In the absence of a valid fraud proof, it goes ahead and accepts the block header as truthful."),(0,r.kt)("h3",{id:"what-does-this-tell-us"},"What does this tell us?"),(0,r.kt)("p",null,"The key takeaway here is that ",(0,r.kt)("strong",{parentName:"p"},"as long as a light node is peered with at least one honest full node, it has practically the same security guarantees as that full node")," (since it can expect to receive a fraud proof from it if the block header it receives is incorrect)."),(0,r.kt)("p",null,"A more subtle insight to be gleaned here is the following: ",(0,r.kt)("strong",{parentName:"p"},"light nodes can only offer the same protection as full nodes if enough people run both light and full nodes.")," This is true because you need enough light nodes in the network to collectively recover blocks, and enough honest full nodes to give every light client a good chance of being connected to at least one of them."),(0,r.kt)("p",null,"It follows that to ensure a resilient network, one in which individuals transacting on Ethereum can detect if/when block producers are trying to ",(0,r.kt)("a",{parentName:"p",href:"https://dankradfeist.de/ethereum/2021/05/20/what-everyone-gets-wrong-about-51percent-attacks.html"},"change the rules")," on them, we need to do two things:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Make it dead simple to run a light node on mobile devices (and other resource-restricted devices)."),(0,r.kt)("li",{parentName:"ol"},"Make it dead simple to run a full node on low-power commodity hardware (in particular this includes Raspberry Pis and everyday laptops).")),(0,r.kt)("p",null,"These two things become ",(0,r.kt)("strong",{parentName:"p"},"especially important in a world in which block production is centralised")," (the ",(0,r.kt)("a",{parentName:"p",href:"https://vitalik.ca/general/2021/12/06/endgame.html"},"likely endgame")," we are heading for)."),(0,r.kt)("h3",{id:"a-means-to-self-sovereignty"},"A means to self-sovereignty"),(0,r.kt)("p",null,"To fork ",(0,r.kt)("a",{parentName:"p",href:"https://twitter.com/jadler0/status/1433985695396282372?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1433985695396282372%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Four.status.im%2Fp%2Fdbab5f30-9e0b-49fb-84c7-ef7adb9d9455%2F"},"the words")," of John Adler: thanks to fraud proofs and data availability sampling, we can think of decentralisation as some function of the cost to run a full node and the cost to run a light node. Not because running either is anything special, but because they are a means to an end: self sovereignty","*",".  "),(0,r.kt)("p",null,"*","Self sovereignty in this context means that we, the community, are able to detect when block producers try to change the rules that we all agree on."),(0,r.kt)("h3",{id:"resources"},"Resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://ethresear.ch/t/beacon-chain-light-client-classification/11061"},"Beacon Chain Light Client Classification"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://ethresear.ch/t/beacon-chain-light-client-networking/11063"},"Beacon Chain Light Client Networking"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://notes.ethereum.org/@ralexstokes/S1RSe1JlF"},"Beacon Chain Light Client Design Doc"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://notes.ethereum.org/@ralexstokes/S1RSe1JlF"},"Bootstrapping the Beacon Chain Light Client Ecosystem"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/ethereum/consensus-specs/blob/dev/specs/altair/sync-protocol.md"},"Altair: Minimum Light Client Spec"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/ChainSafe/eth2-light-client-demo/tree/dapplion/update-to-prater"},"Lodestar Light Client Demo"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/status-im/nimbus-eth2/issues/2337"},"Nimbus Light Client Syncing Implementation"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/etan-status/nimbus-eth2/compare/merkle-multiproof...etan-status:lightclient-api"},"Experimental Nimbus Light Client Server"),(0,r.kt)("br",{parentName:"p"}),"\n","(expand the commit description ... for instructions on how to play with it)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://nimbus.guide/quick-start.html"},"Run a Nimbus Beacon Node"),"  "))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Thanks to Barnab\xe9 Monnot and \u0218tefan Talpalaru for reading drafts of this.")))}p.isMDXComponent=!0},3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),h=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=h(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=h(a),d=r,m=u["".concat(l,".").concat(d)]||u[d]||p[d]||i;return a?n.createElement(m,o(o({ref:t},c),{},{components:a})):n.createElement(m,o({ref:t},c))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var h=2;h<i;h++)o[h]=a[h];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},24866:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/header-2641a1d34eeb1ad7a9a839000e247705.png"}}]);